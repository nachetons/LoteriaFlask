<!DOCTYPE html>
<html>

<head>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  {% include '/components/links.html' %}

</head>

<body>
  {% include '/components/nav.html' %}

  <div class="refresh-container">
    <button class="refreshButton">
      <a href="{{ url_for('marcadores') }}"><i class="fa fa-refresh" aria-hidden="true"></i></a>
    </button>
  </div>

  <table id="tabla-marcadores" class="table">
    <thead>
      <tr class="encabezado">
        <th scope="col">Name</th>
        <th scope="col">Number</th>
        <th scope="col">Adds</th>
        <th scope="col">Date</th>
        <th scope="col">Prize</th>
        <th scope="col">Status</th>
        <th scope="col"></th>


      </tr>
    </thead>
    <tbody>
      
      {% for l in t %}

      {% set estado_class = '' %}

      {% if l.estado == 'acertado' %}
      {% set estado_class = 'text-success' %}
      {% elif l.estado == 'no acertado' %}
      {% set estado_class = 'text-danger' %}
      {% else %}
      {% set estado_class = 'text-warning' %}
      {% endif %}


      <tr class="datosTabla boleto boleto-{{ l.sorteo }}-{{ l.fecha }}-{{ l.numero }}">
        <form id="my-form" method="POST" action="{{ url_for('marcadores') }}">
          <td class="sorteo {{ estado_class }}" data-value="{{ l.sorteo }}">{{ l.sorteo }}</td>
          <td class="numero {{ estado_class }}" data-value="{{ l.numero }}">{{ l.numero }}</td>
          <td class="extra {{ estado_class }}" data-value="{{ l.extra }}">{{ l.extra }}</td>
          <td class="fecha {{ estado_class }}" data-value="{{ l.fecha }}">{{ l.fecha }}</td>
          <td class="premio {{ estado_class }}" data-value="{{ l.premio }}">{{ l.premio }}</td>
          <td class="estado {{ estado_class }}" data-value="{{ l.estado }}">{{ l.estado }}</td>
          <td class=""><button type="button"  name="data"
              value="{{ l.sorteo, l.fecha, l.numero, l.extra }}" onclick="showAlert('{{ l.sorteo }}', '{{ l.fecha }}', '{{ l.numero }}', '{{ l.extra }}')">Borrar</button></td>
        </form>
      </tr>


      
      {% endfor %}

    </tbody>
  </table>


  

  {% include '/components/footer.html' %}

  <script>
    function showAlert(sorteo,fecha,numero,extra){
      const swalWithBootstrapButtons = Swal.mixin({
        customClass: {
          confirmButton: 'btn btn-success',
          cancelButton: 'btn btn-danger'
        },
        buttonsStyling: false
      })
      
      swalWithBootstrapButtons.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Yes, delete it!',
        cancelButtonText: 'No, cancel!',
        reverseButtons: true
      }).then((result) => {
        if (result.isConfirmed) {
          swalWithBootstrapButtons.fire(
            'Deleted!',
            'Your file has been deleted.',
            'success'
          )
          const form = document.getElementById('my-form');
          form.action = '/marcadores'; // actualizar la acci√≥n del formulario
          const input = document.createElement('input');
          input.type = 'hidden';
          input.name = 'data';
          input.value = sorteo + ',' + fecha + ',' + numero + ',' + extra;
          form.appendChild(input); // agregar el campo de datos al formulario
          form.submit();

        } else if (
          /* Read more about handling dismissals below */
          result.dismiss === Swal.DismissReason.cancel
        ) {
          swalWithBootstrapButtons.fire(
            'Cancelled',
            'Your imaginary file is safe :)',
            'error'
          )
        }
      })

    }
  </script>
</body>

</html>